/CLEAR

! Начальные параметры
A=0.5                   ! Длина T-образного элемента
L=1.5                   ! Длина балки
H=0.01                  ! Толщина оболочки
W=0.1                   ! Ширина балки
T=0.02                  ! Толщина балки
E=2E11                  ! Модуль упругости материала
MU=0.3                  ! Коэффициент Пуассона материала

! Выбор КЭ
/PREP7
ET,1,SHELL181           ! Выбираем тип элемента для оболочки
ET,2,BEAM188,,,3        ! Выбираем тип элемента для балки с 3 узлами

! Задаем свойства материала
MP,EX,1,E               ! Задаем модуль упругости материала
MP,PRXY,1,MU            ! Задаем коэффициент Пуассона материала

! Задание сечений
SECTYPE,1,SHELL         ! Задаем сечение для оболочки
SECDATA,H               ! Задаем толщину оболочки
SECTYPE,2,BEAM,T        ! Задаем сечение для балки
SECDATA,W,W,T,T         ! Задаем ширину, высоту и толщину балки

! Перемещение узла для Т-образного КЭ
SECOFFSET,USER,0,W-0.5*T+0.5*H ! Вычисляем и задаем смещение для узлов балки

! Моделирование

! Точки
K,1,0,0,0               ! Задаем узел 1 в начале координат
K,2,A,0,0               ! Задаем узел 2 с координатами (A, 0, 0)
K,3,0,-A,0              ! Задаем узел 3 с координатами (0, -A, 0)

LARC,2,3,1,A            ! Создаем дугу между узлами 2 и 3 с радиусом A
K,4,0,-A,L              ! Задаем узел 4 с координатами (0, -A, L)
L,3,4                   ! Создаем балку между узлами 3 и 4
ADRAG,1,,,,,,2           ! Создаем связь между оболочкой и балкой
/VIEW,1,-0.5,0.5,0.5     ! Устанавливаем вид для графического вывода
GPLOT

NUMMRG,ALL
NUMCMP,ALL

K,6,0,0,L               ! Задаем узел 6 с координатами (0, 0, L)
LSEL,S,LOC,Z,0          ! Выбираем все участки с координатой Z=0
LATT,1,,2,,1,1,2        ! Присоединяем к оболочке балку
ALLSEL
LSEL,S,LOC,Z,L          ! Выбираем все участки с координатой Z=L
LATT,1,,2,,6,6,2        ! Присоединяем к оболочке балку
ALLSEL
AATT,1,,1,,1            ! Присоединяем оболочку к узлу 1
LESIZE,ALL,A/20          ! Устанавливаем размер элементов
AMESH,ALL               ! Создаем сетку для всех участков
LMESH,1                  ! Генерируем сетку для оболочки
LMESH,3                  ! Генерируем сетку для балки
/ESHAPE,1               ! Устанавливаем форму элементов для оболочки
GPLOT

! Закрепления и силы
/SOL
DL,1,,ALL,0              ! Задаем условия нулевого перемещения для узла 1
SFL,3,PRESS,1            ! Задаем распределенную нагрузку на балку
SBCTRAN                 ! Выполняем трансфер распределенных нагрузок на узлы
/PBC,ALL,,1              ! Задаем точки фиксации вдоль координаты Z
/PSF,PRESS,NORM,2,0,1    ! Задаем нормальное распределенное давление на оболочку
GPLOT

ANTYPE,0
PSTRES,1                ! Включаем построение напряжений
SOLVE
/POST1

/SOL
ANTYPE,1
BUCOPT,LANB,1           ! Включаем расчет устойчивости
SOLVE
/POST1

! Вывод частот
SET,LIST
/ESHAPE,		! Сбрасываем форму элементов

SET,,1
PLDISP,1                ! Построение деформаций и перемещений

